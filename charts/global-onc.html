<!DOCTYPE html>
<html lang="en">
    <head>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src="http://d3js.org/topojson.v1.min.js"></script>
	<link href="../assets/css/bootstrap.css" rel="stylesheet">
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.js"></script>
	<link href="../assets/css/axis.css" rel="stylesheet">
	<link href="../assets/css/select.css" rel="stylesheet">
	<link href="../assets/css/range.css" rel="stylesheet">
	<link href="../assets/css/path.css" rel="stylesheet">
	<link href="../assets/css/ts.css" rel="stylesheet">

	<script src="../assets/js/countries.js"></script>
	<script src="../assets/js/incb.js"></script>
	<script src="../assets/js/incb_histo.js"></script>
	<script src="../assets/js/incbMDS.js"></script>
	<script src="../assets/js/incb_histo_levels.js"></script>

	<script src="../assets/js/data.js"></script>
	<script src="../assets/js/histo.js"></script>
	<script src="../assets/js/hover.js"></script>
	<script src="../assets/js/lines.js"></script>
	<script src="../assets/js/map.js"></script>
	<script src="../assets/js/mds.js"></script>
	<script src="../assets/js/scales.js"></script>
	<script src="../assets/js/scatter.js"></script>
	<script src="../assets/js/table.js"></script>
	<script src="../assets/js/ts.js"></script>
	<script src="../assets/js/webpage.js"></script>
    </head>

    <body>


    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="https://bootswatch.com/" class="navbar-brand">Bootswatch</a>
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-collapse collapse" id="navbar-main">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="themes">Themes <span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="themes">
                <li><a href="https://bootswatch.com/default/">Default</a></li>
                <li class="divider"></li>
                <li><a href="https://bootswatch.com/cerulean/">Cerulean</a></li>
                <li><a href="https://bootswatch.com/cosmo/">Cosmo</a></li>
                <li><a href="https://bootswatch.com/cyborg/">Cyborg</a></li>
                <li><a href="https://bootswatch.com/darkly/">Darkly</a></li>
                <li><a href="https://bootswatch.com/flatly/">Flatly</a></li>
                <li><a href="https://bootswatch.com/journal/">Journal</a></li>
                <li><a href="https://bootswatch.com/lumen/">Lumen</a></li>
                <li><a href="https://bootswatch.com/paper/">Paper</a></li>
                <li><a href="https://bootswatch.com/readable/">Readable</a></li>
                <li><a href="https://bootswatch.com/sandstone/">Sandstone</a></li>
                <li><a href="https://bootswatch.com/simplex/">Simplex</a></li>
                <li><a href="https://bootswatch.com/slate/">Slate</a></li>
                <li><a href="https://bootswatch.com/spacelab/">Spacelab</a></li>
                <li><a href="https://bootswatch.com/superhero/">Superhero</a></li>
                <li><a href="https://bootswatch.com/united/">United</a></li>
                <li><a href="https://bootswatch.com/yeti/">Yeti</a></li>
              </ul>
            </li>
            <li>
              <a href="https://bootswatch.com/help/">Help</a>
            </li>
            <li>
              <a href="http://news.bootswatch.com/">Blog</a>
            </li>
            <li class="dropdown">
              <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="download">Yeti <span class="caret"></span></a>
              <ul class="dropdown-menu" aria-labelledby="download">
                <li><a href="http://jsfiddle.net/bootswatch/vdr1vx77/">Open Sandbox</a></li>
                <li class="divider"></li>
                <li><a href="https://bootswatch.com/yeti/bootstrap.min.css">bootstrap.min.css</a></li>
                <li><a href="https://bootswatch.com/yeti/bootstrap.css">bootstrap.css</a></li>
                <li class="divider"></li>
                <li><a href="https://bootswatch.com/yeti/variables.less">variables.less</a></li>
                <li><a href="https://bootswatch.com/yeti/bootswatch.less">bootswatch.less</a></li>
                <li class="divider"></li>
                <li><a href="https://bootswatch.com/yeti/_variables.scss">_variables.scss</a></li>
                <li><a href="https://bootswatch.com/yeti/_bootswatch.scss">_bootswatch.scss</a></li>
              </ul>
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li><a href="http://builtwithbootstrap.com/" target="_blank">Built With Bootstrap</a></li>
            <li><a href="https://wrapbootstrap.com/?ref=bsw" target="_blank">WrapBootstrap</a></li>
          </ul>

        </div>
      </div>
    </div>



	<p> You can see new series by hovering over countries. You can
	    see different years by moving the slider (below the map), and
	    different drugs by changing the selection </p>
	<div class="row-fluid">
	    <div class="span10", id="map"></div>
	</div>
	<div class="row-fluid", id="mapSelect">
	    <div class="span4", id="mapTable">
	    </div>
	    <div class="span2">
		<select class="chzn-select" id="drugSelect"></select>
		</select>
	    </div>
	    <div class="span3">
		<input type="range" min="1989" max="2013" value="1989" id="slider", oninput="updateMapColors()">
	    </div>
	</div>
	<p> You can select different drugs / regions using the selections below.
	    Moving the mouse over a series highlights it, the same function should
	    be able to populate a table with current country info. </p>
	<div class="row-fluid">
	    <div class="span7", id="tsRegions"></div>
	</div>
	<div class ="row-fluid" id="tsSelect">
	    <div class="span2">
		<select class="chzn-select" multiple="true" id="drugSelect"></select>
	    </div>
	    <div class="span5">
		<select class="chzn-select" multiple="true" id="regionSelect"></select>
	    </div>
	</div>

	<p> Select different cognostics using the input. Hovering over circles prints
	    the corresponding series on the side. Maybe we should make the points on
	    hover.
	</p>
	<div class="row-fluid">
	    <div class="span5", id="cognostics"></div>
	    <div class="span5", id="cognosticsSeries"></div>
	</div>
	<div class ="row-fluid" id="cogSelections">
	    <div class="span5", id="cognosticsTable"></div>
	    <div class="span2">
		<select class="chzn-select" id="cogSelect"></select>
	    </div>
	    <div class="span2">
		<select class="chzn-select" multiple="true" id="drugSelect"></select>
	    </div>
	    <div class="span2">
		<select class="chzn-select" multiple="true" id="regionSelect"></select>
	    </div>
	</div>

	<div class="row-fluid">
	    <div class="span5", id="mdsSeries"></div>
	    <div class="span5", id="mdsScatter"></div>
	</div>
	<div class ="row-fluid" id="mdsSelect">
	    <div class="span5", id="mdsTable"></div>
	    <div class="span2">
		<select class="chzn-select" multiple="true" id="drugSelect"></select>
	    </div>
	    <div class="span2">
		<select class="chzn-select" multiple="true" id="regionSelect"></select>
	    </div>
	</div>

	<script type="text/javascript">
	 // draw for the first time
	 const map = $("#map");
	 const ts = $("#ts");
	 const tsRegions = $("#tsRegions");
	 const cognostics = $("#cognostics");
	 const mds = $("#mdsScatter");
	 const mdsSeries = $("#mdsSeries");

	 setupSVG("#mdsScatter", .95 * mds.width(), .6 * mds.width(), "#F7F7F7");
	 setupSVG("#mdsSeries", .95 * mdsSeries.width(), .6 * mdsSeries.width(), "#F7F7F7");
	 setupMapVis(incb, countries, map.width(), .35 * map.width());
	 setupSVG("#tsRegions", tsRegions.width(), 0.4 * tsRegions.width(), "#F7F7F7");
	 setupSVG("#cognostics", cognostics.width(), 0.35 * cognostics.width(), "#F7F7F7");
	 setupSVG("#cognosticsSeries", cognostics.width(), 0.35 * cognostics.width(), "#F7F7F7");

	 makeTable("#mapTable", ["json_country", "region", "subregion", "gdp_num"]);
	 makeTable("#cognosticsTable", ["group_id"]);
	 makeTable("#mdsTable", ["group_id"]);

	 // add selections for map
	 allDrugs = Object.keys(incb[0].ts);
	 allDrugs.shift();
	 fillOptions("#mapSelect #drugSelect", allDrugs);
	 $("#mapSelect #drugSelect").on("change", updateMapColors);
	 $("#mapSelect #drugSelect").on("change", updateMapColors);

	 // draw the map
	 updateMapColors();

	 // add selections for trends
	 allSubregions = ["northern_africa", "middle_africa", "east_africa", "west_africa", "south_africa", "western_asia", "central_asia", "southern_asia", "east_asia", "southeast_asia", "australia_nz",  "melanesia", "polynesia",  "micronesia", "southern_europe","western_europe", "northern_europe", "eastern_europe", "central_america", "carribean", "south_america", "north_america"]
	 fillOptions("#tsSelect #drugSelect", allDrugs);
	 fillOptions("#tsSelect #regionSelect", allSubregions);
	 $("#tsSelect #drugSelect").on("change", updateShownTS)
	 $("#tsSelect #regionSelect").on("change", updateShownTS);

	 // add selections for cognostics
	 allRegions = ["asia", "africa", "americas", "europe", "oceania"]
	 const allCogs = incb_histo[0].map(function(d) { return d["L1"] })
	 fillOptions("#cogSelections #cogSelect", allCogs);
	 fillOptions("#cogSelections #drugSelect", allDrugs);
	 fillOptions("#cogSelections #regionSelect", allRegions);
	 $("#cogSelections #regionSelect").on("change", updateCognostics);
	 $("#cogSelections #cogSelect").on("change", updateCognostics);
	 $("#cogSelections #drugSelect").on("change", updateCognostics);

	 // add selections for mds
	 fillOptions("#mdsSelect #drugSelect", allDrugs);
	 fillOptions("#mdsSelect #regionSelect", allSubregions);
	 $("#mdsSelect #drugSelect").on("change", updateMDS);
	 $("#mdsSelect #regionSelect").on("change", updateMDS);

	 drawMDS(d3.selectAll("#mdsScatter > svg"), incbMDS);
	</script>

	<script type="text/javascript">
	 // use multiselect plugin
	 $(function(){
	     $(".chzn-select").chosen();
	 });
	</script>

	<script type="text/javascript" src="bootstrap/js/bootstrap.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.4.2/chosen.jquery.js"></script>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/chosen/1.4.2/chosen.css">
    </body>
</html>

